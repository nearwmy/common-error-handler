(function(n,e){typeof exports=="object"&&typeof module!="undefined"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis!="undefined"?globalThis:n||self,e(n.lib={}))})(this,function(n){"use strict";var y=Object.defineProperty;var _=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var O=(n,e,r)=>e in n?y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,E=(n,e)=>{for(var r in e||(e={}))b.call(e,r)&&O(n,r,e[r]);if(_)for(var r of _(e))S.call(e,r)&&O(n,r,e[r]);return n};var s=(n,e,r)=>(O(n,typeof e!="symbol"?e+"":e,r),r);const e={NETWORK_ERROR:"Network Error",TIMEOUT_ABORTED:"ECONNABORTED",INVALID_TOKEN:"INVALID_TOKEN",INVALID_TOKEN_CODE:413},r={PERMISSION_DENIED:3,INVALID_AUTH:8,AUTH_EXPIRED:9},D={CONTENT_lOADED_FAILED:11003,PERMISSION_DENIED:11004,INTERNAL_ERROR:11009,ACCOUNT_DEACTIVATION:11010,AUTH_EXPIRED:11005,SENSITIVE_CONTENT:11008,TRAFFIC_EXCEEDED:22005,SERVER_ERROR:22006,TOO_FREQUENT:11006,REACHED_LIMIT:11007,FORMAT_ERROR:22222};var g=E(E(E({},e),r),D);class c extends Error{}s(c,"type","edam"),s(c,"code","");class H extends Error{}s(H,"type","grpc");class I extends Error{}s(I,"type","restful");var A={EdamError:c,GrpcError:H,RestfulError:I};const R=Symbol();let f=null;const T=a=>{if(a instanceof Error)throw Error;return a};class d{constructor(t){s(this,"configHandlers");s(this,"finalHandler",T);if(t!==R)throw new Error("can not create a ErrorHandler instance");this.configHandlers=new Map}static getInstance(){return f===null&&(f=new d(R)),f}registerHandlers(t){const i=Object.keys(t);for(let l=0;l<i.length;l++)this.configHandlers.set(i[l],t[i[l]])}registerFinalHandler(t){if(typeof t=="function")this.finalHandler=t;else throw new Error("final handler must be function")}unregisterHandlers(t){for(let i=0;i++;i<t.length)this.configHandlers.delete(t[i])}unregisterFinalHandler(){this.finalHandler=T}getConfigHandlers(){return this.configHandlers}getFinalHandler(){return this.finalHandler}handler(t){if(t!=null){const i=u=>{try{typeof this.finalHandler=="function"&&this.finalHandler(u)}catch(o){console.warn(`occur an error in finalHandler handler
`,o)}};let l=!1,N=0;Array.from(this.configHandlers).forEach(u=>{const o=u[1];let h=!0;const C={stopPropagation(){h=!1}};try{o.condition(t)&&o.handler(t,C)}catch(p){i(p)}l=!0,h&&N++}),(!l||N>0)&&i(t)}}}n.RequestError=A,n.default=d,n.errorCodes=g,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
