(function(n,e){typeof exports=="object"&&typeof module!="undefined"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis!="undefined"?globalThis:n||self,e(n.lib={}))})(this,function(n){"use strict";var p=Object.defineProperty;var g=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var H=(n,e,r)=>e in n?p(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,c=(n,e)=>{for(var r in e||(e={}))y.call(e,r)&&H(n,r,e[r]);if(g)for(var r of g(e))S.call(e,r)&&H(n,r,e[r]);return n};var o=(n,e,r)=>(H(n,typeof e!="symbol"?e+"":e,r),r);const e={NETWORK_ERROR:"Network Error",TIMEOUT_ABORTED:"ECONNABORTED",INVALID_TOKEN:"INVALID_TOKEN",INVALID_TOKEN_CODE:413},r={PERMISSION_DENIED:3,INVALID_AUTH:8,AUTH_EXPIRED:9},_={CONTENT_lOADED_FAILED:11003,PERMISSION_DENIED:11004,INTERNAL_ERROR:11009,ACCOUNT_DEACTIVATION:11010,AUTH_EXPIRED:11005,SENSITIVE_CONTENT:11008,TRAFFIC_EXCEEDED:22005,SERVER_ERROR:22006,TOO_FREQUENT:11006,REACHED_LIMIT:11007,FORMAT_ERROR:22222};var D=c(c(c({},e),r),_);class d extends Error{}o(d,"type","edam"),o(d,"code","");class I extends Error{}o(I,"type","grpc");class R extends Error{}o(R,"type","restful");var A={EdamError:d,GrpcError:I,RestfulError:R};const T=Symbol();let E=null;const h=s=>{if(s instanceof Error)throw Error;return s};class f{constructor(t){o(this,"configHandlers");o(this,"finalHandler",h);if(t!==T)throw new Error("can not create a ErrorHandler instance");this.configHandlers=new Map}static getInstance(){return E===null&&(E=new f(T)),E}registerHandlers(t){const l=Object.keys(t);for(let i=0;i<l.length;i++)this.configHandlers.set(l[i],t[l[i]])}registerFinalHandler(t){if(typeof t=="function")this.finalHandler=t;else throw new Error("final handler must be function")}unregisterHandlers(t){for(let l=0;l++;l<t.length)this.configHandlers.delete(t[l])}unregisterFinalHandler(){this.finalHandler=h}getConfigHandlers(){return this.configHandlers}getFinalHandler(){return this.finalHandler}handler(t){if(t!=null){const l=O=>{try{typeof this.finalHandler=="function"&&this.finalHandler(O)}catch(a){console.warn(`occur an error in finalHandler handler
`,a)}};let i=!1,u=0;Array.from(this.configHandlers).forEach(O=>{const a=O[1];if(a.condition(t)){let N=!0;const C={stopPropagation(){N=!1}};try{a.handler(t,C)}catch(b){l(b)}i=!0,N&&u++}}),console.log("needBubble====",u),console.log("handled=====",i),(!i||u>0)&&l(t)}}}n.RequestError=A,n.default=f,n.errorCodes=D,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
