(function(e,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e.lib={}))})(this,function(e){"use strict";var b=Object.defineProperty;var N=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var O=(e,n,r)=>n in e?b(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,E=(e,n)=>{for(var r in n||(n={}))p.call(n,r)&&O(e,r,n[r]);if(N)for(var r of N(n))y.call(n,r)&&O(e,r,n[r]);return e};var i=(e,n,r)=>(O(e,typeof n!="symbol"?n+"":n,r),r);const n={NETWORK_ERROR:"Network Error",TIMEOUT_ABORTED:"ECONNABORTED",INVALID_TOKEN:"INVALID_TOKEN",INVALID_TOKEN_CODE:413},r={PERMISSION_DENIED:3,INVALID_AUTH:8,AUTH_EXPIRED:9},H={CONTENT_lOADED_FAILED:11003,PERMISSION_DENIED:11004,INTERNAL_ERROR:11009,ACCOUNT_DEACTIVATION:11010,AUTH_EXPIRED:11005,SENSITIVE_CONTENT:11008,TRAFFIC_EXCEEDED:22005,SERVER_ERROR:22006,TOO_FREQUENT:11006,REACHED_LIMIT:11007,FORMAT_ERROR:22222};var T=E(E(E({},n),r),H);class d extends Error{}i(d,"type","edam"),i(d,"code","");class g extends Error{constructor(s){super();i(this,"code","");i(this,"message","");this.code=s.code,this.message=s.message}}i(g,"type","grpc");class D extends Error{}i(D,"type","restful");var A={EdamError:d,GrpcError:g,RestfulError:D};const _=Symbol();let f=null;const h=l=>{if(l instanceof Error)throw Error;return l};class u{constructor(t){i(this,"configHandlers");i(this,"finalHandler",h);if(t!==_)throw new Error("ERROR_HANDLER: can not create a ErrorHandler instance");this.configHandlers=new Map}static getInstance(){return f===null&&(f=new u(_)),f}registerHandlers(t){const s=Object.keys(t);for(let o=0;o<s.length;o++)this.configHandlers.set(s[o],t[s[o]])}registerFinalHandler(t){if(typeof t=="function")this.finalHandler=t;else throw new Error("ERROR_HANDLER: final handler must be function")}unregisterHandlers(t){for(let s=0;s++;s<t.length)this.configHandlers.delete(t[s])}unregisterFinalHandler(){this.finalHandler=h}getConfigHandlers(){return this.configHandlers}getFinalHandler(){return this.finalHandler}assert(t,s){const o=this.configHandlers.get(t);if(o){const{condition:a}=o;return a(s)}else return console.warn(`ERROR_HANDLER: ${t} is not found in configHandlers`),!1}handler(t){if(t!=null){const s=R=>{try{typeof this.finalHandler=="function"&&this.finalHandler(R)}catch(c){console.warn(`occur an error in finalHandler handler
`,c)}};let o=!1,a=0;Array.from(this.configHandlers).forEach(R=>{const c=R[1];if(c.condition(t)){let I=!0;const C={stopPropagation(){I=!1}};try{c.handler(t,C)}catch(S){s(S)}o=!0,I&&a++}}),console.log("needBubble====",a),console.log("handled=====",o),(!o||a>0)&&s(t)}}}e.EDAM_CODES=r,e.GRPC_CODES=H,e.RequestError=A,e.default=u,e.errorCodes=T,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
